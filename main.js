const express = require('express');
const bodyParser = require('body-parser');
const axios = require('axios');
const cors = require('cors');

const app = express();
const PORT = 3000;

// Ð’Ð°Ñˆ Ñ‚Ð¾ÐºÐµÐ½ Ð±Ð¾Ñ‚Ð°
const botToken = '7916610016:AAFFD8YefmuKm6w0gg89qJ1c0eAuYvdiy6s'; // Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹Ñ‚Ðµ ÑÐ²Ð¾Ð¹ Ñ‚Ð¾ÐºÐµÐ½
// chat_id Ð²Ð°ÑˆÐµÐ¹ Ð³Ñ€ÑƒÐ¿Ð¿Ñ‹ (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, -1234567890)
const chatId = '1723957261'; // Ð£Ð±ÐµÐ´Ð¸Ñ‚ÐµÑÑŒ, Ñ‡Ñ‚Ð¾ ÑÑ‚Ð¾ Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ñ‹Ð¹ chat_id Ð²Ð°ÑˆÐµÐ¹ Ð³Ñ€ÑƒÐ¿Ð¿Ñ‹

app.use(bodyParser.json());
app.use(cors()); // ÐŸÐ¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ CORS

// ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº POST-Ð·Ð°Ð¿Ñ€Ð¾ÑÐ° Ð¾Ñ‚ Ñ„Ð¾Ñ€Ð¼Ñ‹
app.post('/submit', async (req, res) => {
  const { name, email, phone, message } = req.body;

  if (!name || !email || !phone || !message) {
    return res.status(400).json({ message: 'Ð’ÑÐµ Ð¿Ð¾Ð»Ñ Ð¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹ Ð´Ð»Ñ Ð·Ð°Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ!' });
  }

  // ÐŸÐ¾Ð»ÑƒÑ‡Ð°ÐµÐ¼ Ñ‚ÐµÐºÑƒÑ‰ÐµÐµ Ð²Ñ€ÐµÐ¼Ñ
  const currentTime = new Date().toLocaleString("ru-RU", {
    timeZone: "Asia/Tashkent", // Ð£ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÐ¼ Ð½ÑƒÐ¶Ð½Ñ‹Ð¹ Ñ‡Ð°ÑÐ¾Ð²Ð¾Ð¹ Ð¿Ð¾ÑÑ
    hour12: false,
  });

  // Ð¤Ð¾Ñ€Ð¼Ð¸Ñ€ÑƒÐµÐ¼ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Ð´Ð»Ñ Telegram
  const text = `
ðŸ“ ÐÐ¾Ð²Ð°Ñ Ð·Ð°ÑÐ²ÐºÐ°:
ðŸ‘¤ Ð˜Ð¼Ñ: ${name}
ðŸ“§ Email: ${email}
ðŸ“ž Ð¢ÐµÐ»ÐµÑ„Ð¾Ð½: ${phone}
ðŸ’¬ Ð¡Ð¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ: ${message}
â° Ð’Ñ€ÐµÐ¼Ñ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÐ¸: ${currentTime}
  `;

  try {
    // ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð»ÑÐµÐ¼ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð² Telegram
    await axios.post(`https://api.telegram.org/bot${botToken}/sendMessage`, {
      chat_id: chatId,
      text: text,
    });

    // Ð£Ð²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ðµ Ð¾Ð± ÑƒÑÐ¿ÐµÑˆÐ½Ð¾Ð¹ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÐµ
    res.json({ message: 'Ð”Ð°Ð½Ð½Ñ‹Ðµ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ñ‹ Ð² Telegram!' });
  } catch (error) {
    console.error('ÐžÑˆÐ¸Ð±ÐºÐ° Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÐ¸ Ð² Telegram:', error.message);
    res.status(500).json({ message: 'ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÐµ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð² Telegram' });
  }
});

// Ð—Ð°Ð¿ÑƒÑÐº ÑÐµÑ€Ð²ÐµÑ€Ð°
app.listen(PORT, () => {
  console.log(`Ð¡ÐµÑ€Ð²ÐµÑ€ Ð·Ð°Ð¿ÑƒÑ‰ÐµÐ½ Ð½Ð° http://localhost:${PORT}`);
});








// ÐÐ°Ñ…Ð¾Ð´Ð¸Ð¼ ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚Ñ‹
const hamburger = document.querySelector(".nav__hamburger");
const menu = document.querySelector(".nav__menu");

// ÐžÑ‚ÐºÑ€Ñ‹Ñ‚Ð¸Ðµ/Ð·Ð°ÐºÑ€Ñ‹Ñ‚Ð¸Ðµ Ð¼ÐµÐ½ÑŽ
hamburger.addEventListener("click", () => {
  menu.classList.toggle("active");
  hamburger.classList.toggle("active");
});

// Ð—Ð°ÐºÑ€Ñ‹Ñ‚Ð¸Ðµ Ð¼ÐµÐ½ÑŽ Ð¿Ñ€Ð¸ ÐºÐ»Ð¸ÐºÐµ Ð½Ð° ÑÑÑ‹Ð»ÐºÑƒ
document.querySelectorAll(".nav__menu__link a").forEach((link) => {
  link.addEventListener("click", () => {
    menu.classList.remove("active");
    hamburger.classList.remove("active");
  });
});

// ÐžÑ‚ÑÐ»ÐµÐ¶Ð¸Ð²Ð°ÐµÐ¼ Ñ€Ð°Ð·Ð¼ÐµÑ€ ÑÐºÑ€Ð°Ð½Ð°, Ñ‡Ñ‚Ð¾Ð±Ñ‹ ÑÐºÑ€Ñ‹Ñ‚ÑŒ Ð¼ÐµÐ½ÑŽ Ð¿Ñ€Ð¸ Ñ€ÐµÑÐ°Ð¹Ð·Ðµ
window.addEventListener("resize", () => {
  if (window.innerWidth > 768) {
    menu.classList.remove("active");
    hamburger.classList.remove("active");
  }
});
